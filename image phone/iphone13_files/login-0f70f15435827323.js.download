(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9861],{19401:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/users/login",function(){return n(85357)}])},97456:function(e,t,n){"use strict";n.d(t,{J:function(){return l}});var r=n(70865),s=n(66383),o=n(2784),i=n(98634),a=n(95846),u=n(50020);function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.ZT,l=(0,r.Z)({hasMillieSeconds:!1},t).hasMillieSeconds,c=(0,o.useRef)(null),d=function(){return e<=Date.now()||(0,u.k)(e)?0:l?e-Date.now():Math.floor((e-Date.now())/1e3)},m=(0,s.Z)((0,o.useState)((0,a.R)(d(),t,c)),2),f=m[0],p=m[1];return(0,o.useEffect)(function(){return d()>0&&(c.current=setInterval(function(){var r=Math.floor((e-Date.now())/1e3);r<=0&&(null==n||n()),p((0,a.R)(r,t,c))},1e3)),function(){return clearInterval(c.current)}},[e]),f}},67602:function(e,t,n){"use strict";n.d(t,{W:function(){return l}});var r=n(70865),s=n(96670),o=n(66383),i=n(52322),a=n(2784),u=n(21494);function l(e){var t=(0,o.Z)((0,a.useState)(!1),2),n=t[0],l=t[1],c=function(){l(function(e){return!e})};return(0,i.jsx)(u.I,(0,s.Z)((0,r.Z)({},e),{type:n?"text":"password",leftIcon:n?"visibilityOff":"visibilityOn",leftIconOnClick:function(e){e.stopPropagation(),c()}}))}},60465:function(e,t,n){"use strict";n.d(t,{w:function(){return r}});var r={auth:"AUTH",password:"PASSWORD",otp:"OTP",register:"REGISTER"}},85357:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return J}});var r=n(52322),s=n(88589),o=n(41701),i=n(66383),a=n(2784),u=n(8050),l=n(7969),c=n(60465),d=n(59437),m=n(57931),f=n(16137),p=n(21494),h=n(27768),v=n(8290),x=n(96495),g=n(26442),N=n(11559),w=n(70387),S=n(49291),j=n(45227),y=n(1324),O=(0,y.q)({type:j.XN.POST,url:"user/authenticate/",transformer:function(e){var t=e.data||{};return{hasPassword:t.has_password,hasAccount:t.has_account,loginMethod:t.login_method,timer:t.sms_ttl,username:t.phone}},inputTransformer:function(e){return{username:(null==e?void 0:e.username)||(null==e?void 0:e.phone),otp_call:(null==e?void 0:e.otpCall)||!1,force_send_otp:null==e?void 0:e.forceSendOtp}}});function b(e){var t=e.setStep,n=e.setResponse,s=e.setUsername,o=(0,w.O)().sendInTrackUserEvent,i=(0,N.E)({apiMethod:O,onSuccess:function(e){return(n(e),e.hasAccount)?e.loginMethod===x.e.PASSWORD?t(c.w.password):t(c.w.otp):t(c.w.register)}}),a=i.request,u=i.pending;return(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsx)("h1",{className:"text-h4 text-neutral-900 text-right w-full mt-4",children:"ورود | ثبت‌نام"}),(0,r.jsx)("p",{className:"text-body-2 text-neutral-700 mt-4 text-right w-full",children:"سلام!"}),(0,r.jsx)("p",{className:"text-body-2 text-neutral-700 mb-4 text-right w-full",children:"لطفا شماره موبایل یا ایمیل خود را وارد کنید"}),(0,r.jsx)(f.l,{useFormProps:{mode:"onBlur"},onSubmit:function(e){var t=e.username.trim();o({eventName:v.M.LOGIN_CONTINUE,eventData:{isValid:!0,isMobile:(0,S.k8)(t)}}),s(t),a({username:t})},items:[{component:(0,r.jsx)(p.I,{autoFocus:!0,inputWrapperProps:{fullWidth:!0}}),name:"username",defaultValue:"",rules:{required:h.Qt,validate:S.jI}},{component:(0,r.jsx)(m.z,{type:"submit",color:"primary",size:"large",mode:"filled",className:"w-full mt-6 lg:mt-8 text-button-1",isLoading:u,CROId:"login-register",children:"ورود"})}]}),(0,r.jsxs)("p",{className:"text-caption text-neutral-700 mt-4",children:["ورود شما به معنای پذیرش",(0,r.jsx)(d.e,{mode:"link",href:g.A2,className:"mx-1 inline-block text-secondary-700",children:"شرایط دیجی‌کالا"}),"و",(0,r.jsx)(d.e,{mode:"link",href:g.SL,className:"mx-1 inline-block text-secondary-700",children:"قوانین حریم‌خصوصی"}),"است"]})]})}var M=n(98780),_=n(25509),P=n(64952),C=n(57394),I=n(90247),R=n(34895),T=n(46943),L=n(73076),D=n(52216);function E(e){var t,n=e.response,s=e.setStep,o=e.setResponse,u=(0,i.Z)((0,a.useState)(""),2),l=u[0],d=u[1],p=(0,I.c)(),g=p.ref,j=p.submit,y=(0,w.O)().sendInTrackUserEvent,b=(0,a.useRef)(new Date),E=Boolean(+n.username.slice(-1)%2),k=(0,C.J)({action:T.y}),U=k.request,z=k.pending,A=(0,N.E)({apiMethod:O,onSuccess:function(e){return o(e)},onError:function(e){var t;return d(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.message)}}),W=A.request,Z=A.pending;return(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsx)("h1",{className:"text-h4 text-neutral-900 text-right w-full mt-4",children:"کد تایید را وارد کنید"}),(0,r.jsx)("p",{className:"text-body-2 text-neutral-700 my-4 text-right w-full",children:"کد تایید برای شماره ".concat((0,D.U)(n.username)," پیامک شد")}),(0,r.jsx)(f.l,{ref:g,onSubmit:function(e){y({eventName:v.M.LOGIN_CONFIRM,eventData:{isOTP:!0,isNewUser:!1}}),U({username:n.username,code:(0,L.d)(e.code),type:x.e.OTP}).then(function(){return(0,R.zB)(n.username,E,!0)}).catch(function(){return(0,R.zB)(n.username,E,!1)})},items:[{component:(0,r.jsx)(_.N,{submit:j,shouldUseWebOTP:E}),name:"code",defaultValue:"",rules:{validate:{numberValidation:S.AU,length5:function(e){return 5===e.length||h.VP}}}}]}),n.hasPassword&&(0,r.jsxs)(m.z,{mode:"text",color:"secondary",size:"small",className:"mt-4",onClick:function(){y({eventName:v.M.PASSWORD_LOGIN}),s(c.w.password)},removePadding:!0,children:["ورود با رمز عبور",(0,r.jsx)(M.J,{icon:"chevronLeft",size:20,color:"secondary"})]}),(0,r.jsx)(P.U,{error:l,endTime:1e3*n.timer+(null===(t=b.current)||void 0===t?void 0:t.getTime()),onResend:function(e){var t=e.otpCall;b.current=new Date,W({username:n.username,forceSendOtp:!0,otpCall:void 0!==t&&t})},isLoading:Z}),(0,r.jsx)(m.z,{type:"submit",color:"primary",size:"large",mode:"filled",className:"w-full mt-4",isLoading:z,CROId:"login-verification-code",onClick:j,children:"تایید"})]})}var k=n(98742),U=n(27314),z=n(58777),A=n(67602);function W(e){var t=e.setStep,n=e.setResponse,s=e.response,o=e.username,i=(0,U.e)().redirect,a=(0,I.c)(),u=a.ref,l=a.submit,d=(0,w.O)().sendInTrackUserEvent,p=(0,C.J)({action:T.y}),S=p.request,j=p.pending,y=(0,N.E)({apiMethod:O,onSuccess:function(e){n(e),t(c.w.otp)}}),b=y.request,_=y.pending;return(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsx)("h1",{className:"text-h4 text-neutral-900 text-right w-full my-4",children:"رمز عبور را وارد کنید"}),(0,r.jsx)(f.l,{ref:u,onSubmit:function(e){d({eventName:v.M.LOGIN_CONFIRM,eventData:{isOTP:!1,isNewUser:!1}}),S({username:o,password:e.password,type:x.e.PASSWORD}).then(function(e){(null==e?void 0:e.shouldConfirmPhone)&&i({url:g.ih})})},items:[{component:(0,r.jsx)(A.W,{isRequired:!0,helper:" ",autoFocus:!0,inputWrapperProps:{fullWidth:!0}}),name:"password",defaultValue:"",rules:{required:h.gt}}]}),s.username&&(0,r.jsxs)(m.z,{mode:"text",color:"secondary",size:"small",onClick:function(){d({eventName:v.M.OTP_LOGIN}),b({username:s.username,forceSendOtp:!0})},className:"mt-3 p-0",removePadding:!0,isLoading:_,children:["ورود با رمز یک‌بار‌مصرف",(0,r.jsx)(M.J,{icon:"chevronLeft",size:20,color:"secondary"})]}),(0,r.jsxs)(m.z,{mode:"text",color:"secondary",size:"small",onClick:function(){d({eventName:v.M.FORGET_PASSWORD}),(0,z.d)(k.x,s.username||o||""),i({url:g.sx})},className:"mt-3 p-0",removePadding:!0,children:["فراموشی رمز عبور",(0,r.jsx)(M.J,{icon:"chevronLeft",size:20,color:"secondary"})]}),(0,r.jsx)(m.z,{type:"submit",color:"primary",size:"large",mode:"filled",className:"w-full mt-8",isLoading:j,onClick:l,children:"تایید"})]})}var Z=(0,y.q)({type:j.XN.POST,url:"user/register/confirm/",inputTransformer:function(e){return{username:e.username,code:e.code}}});function q(e){var t=e.response,n=e.setResponse,s=(0,U.e)().redirect,o=(0,a.useRef)(new Date),u=(0,I.c)(),l=u.ref,c=u.submit,d=(0,w.O)().sendInTrackUserEvent,p=(0,i.Z)((0,a.useState)(""),2),x=p[0],j=p[1],y=(0,N.E)({apiMethod:O,onSuccess:function(e){return n(e)},onError:function(e){var t;return j(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.message)}}),b=y.request,M=y.pending,C=(0,N.E)({apiMethod:Z,onSuccess:function(){return s({url:g.iR})}}),R=C.request,T=C.pending;return(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsx)("h1",{className:"text-h4 text-neutral-900 text-right w-full mt-4",children:"کد تایید را وارد کنید"}),(0,r.jsx)("p",{className:"text-body-2 text-neutral-700 my-4 text-right w-full",children:"حساب کاربری با شماره موبایل\n        ".concat((0,D.U)(t.username),"\n        وجود ندارد. برای ساخت حساب جدید، کد تایید برای این شماره ارسال گردید.")}),(0,r.jsx)(f.l,{ref:l,onSubmit:function(e){d({eventName:v.M.LOGIN_CONFIRM,eventData:{isOTP:!0,isNewUser:!0}}),R({username:t.username,code:e.code})},items:[{component:(0,r.jsx)(_.N,{submit:c}),name:"code",defaultValue:"",rules:{validate:{numberValidation:S.AU,length5:function(e){return 5===e.length||h.VP}}}}]}),(0,r.jsx)(P.U,{error:x,isLoading:M,endTime:1e3*t.timer+o.current.getTime(),onResend:function(e){var n=e.otpCall;o.current=new Date,b({username:t.username,forceSendOtp:!0,otpCall:void 0!==n&&n})}}),(0,r.jsx)(m.z,{type:"submit",color:"primary",size:"large",mode:"filled",className:"w-full mt-6 lg:mt-8",isLoading:T,onClick:c,children:"ادامه"})]})}function F(e){var t=e.className,n=(0,i.Z)((0,a.useState)(c.w.auth),2),s=n[0],o=n[1],d=(0,i.Z)((0,a.useState)(null),2),m=d[0],f=d[1],p=(0,i.Z)((0,a.useState)(""),2),h=p[0],v=p[1],x=s!==c.w.auth;return(0,r.jsxs)(u.p,{className:t,children:[(0,r.jsx)(l.G,{setStep:o,firstStep:c.w.auth,hasBack:x,logoHiddenInMobile:x,isIconFixedMobile:!0}),function(){switch(s){case c.w.auth:return(0,r.jsx)(b,{setStep:o,setResponse:f,setUsername:v});case c.w.password:return(0,r.jsx)(W,{setStep:o,response:m,setResponse:f,username:h});case c.w.otp:return(0,r.jsx)(E,{setStep:o,response:m,setResponse:f});case c.w.register:return(0,r.jsx)(q,{response:m,setResponse:f});default:return null}}()]})}var J=(0,o.D)({component:function(){return(0,r.jsx)(F,{})},redirectIfLogin:!0,layoutProps:{type:s.B.CENTER,justify:"center",hasBottomNav:!0}})},8050:function(e,t,n){"use strict";n.d(t,{p:function(){return u}});var r=n(47842),s=n(52322),o=n(72677),i=n(77997),a=n.n(i);function u(e){var t=e.children,n=e.className,i=e.width,u=(0,o.d)("lg:border-complete-200 rounded-medium p-5 lg:p-8","flex flex-col items-center justify-start lg:justify-center",(0,r.Z)({},a().AccountWrapper__mainBox,!i),i,n);return(0,s.jsx)("div",{className:u,children:t})}},25509:function(e,t,n){"use strict";n.d(t,{N:function(){return g}});var r=n(70865),s=n(26297),o=n(66383),i=n(52322),a=n(2784),u=n(21494),l=n(73076),c=n(41435),d=n(98788),m=n(5163),f=n(4547);function p(){return(p=(0,d.Z)(function(){var e;return(0,m.__generator)(this,function(t){switch(t.label){case 0:if(!("OTPCredential"in window))return[3,2];return e=new AbortController,[4,navigator.credentials.get({otp:{transparent:["sms"]},signal:e.signal}).then(function(e){return null==e?void 0:e.code}).catch(function(t){(0,f.g)(t),e.abort()})];case 1:t.sent(),t.label=2;case 2:return[2]}})})).apply(this,arguments)}var h=n(72677),v=n(82023),x=n.n(v);function g(e){var t=e.onChange,n=e.error,d=e.name,m=e.codeLength,f=void 0===m?5:m,v=e.submit,g=e.inputWrapperProps,N=e.shouldUseWebOTP,w=void 0!==N&&N,S=(0,s.Z)(e,["onChange","error","name","codeLength","submit","inputWrapperProps","shouldUseWebOTP"]),j=(0,o.Z)((0,a.useState)(""),2),y=j[0],O=j[1];(0,a.useEffect)(function(){w&&(0,c.x)(y)&&(function(){return p.apply(this,arguments)})().then(function(e){return O(String(e))})},[y]);var b=function(e){return null==e?void 0:e.replace(/[-]/g,"")},M=function(e){e.length===f&&setTimeout(function(){v()},0)};return(0,i.jsx)(u.I,(0,r.Z)({name:void 0===d?"code":d,onChange:function(e){var n=e.target.value;if(n.length<2*f-1){t(b((0,l.d)(n)));var r,s,o,i=null==n?void 0:null===(r=n.split)||void 0===r?void 0:null===(s=r.call(n,""))||void 0===s?void 0:null===(o=s.join)||void 0===o?void 0:o.call(s,"-");(i&&Number(b(i))||""===i)&&O(i)}M(n)},autoFocus:!0,maxLength:f+Math.round(f/2)+1,inputMode:"numeric",type:"text",inputClassName:(0,h.d)("text-center",x().codeInput__trackingOtp),value:y,error:n,inputWrapperProps:void 0===g?{fullWidth:!0}:g,autoComplete:w&&"one-time-code"},S))}},64952:function(e,t,n){"use strict";n.d(t,{U:function(){return u}});var r=n(52322),s=n(57931),o=n(98780),i=n(3005),a=n(72677);function u(e){var t=e.error,n=e.endTime,u=e.onResend,l=e.isLoading,c=e.shouldHideOTPCall,d=e.buttonColor,m=e.descriptionColor,f=void 0===m?"text-neutral-700":m,p=(0,i.J)(n,{hasHours:!1}),h=function(){u({otpCall:!1})};return t?(0,r.jsx)("p",{className:(0,a.d)("w-full mt-4 text-center text-body-2 py-2",f),children:t}):n&&0!==p?(0,r.jsxs)("p",{className:(0,a.d)("w-full mt-4 text-center text-body-2 py-2",f),children:[(0,r.jsx)("span",{className:"w-10 inline-block mx-1 text-center",children:p}),"مانده تا دریافت مجدد کد"]}):void 0!==c&&c?(0,r.jsx)(s.z,{mode:"text",size:"small",color:void 0===d?"secondary":d,onClick:h,isLoading:l,className:"mt-4 w-full",children:"دریافت مجدد کد تایید"}):(0,r.jsxs)("div",{className:"w-full flex items-center justify-center mb-6 mt-4 text-caption user-select-none",children:["دریافت مجدد کد از طریق",(0,r.jsxs)("span",{onClick:h,className:"flex items-center text-secondary-500 mx-2 cursor-pointer",children:["پیامک",(0,r.jsx)(o.J,{icon:"chevronLeft",size:20,color:"secondary"})]}),"یا",(0,r.jsxs)("span",{onClick:function(){u({otpCall:!0})},className:"flex items-center text-secondary-500 mx-2 cursor-pointer",children:["تماس",(0,r.jsx)(o.J,{icon:"chevronLeft",size:20,color:"secondary"})]})]})}},3005:function(e,t,n){"use strict";n.d(t,{J:function(){return r.J}});var r=n(97456)},41701:function(e,t,n){"use strict";function r(e){var t=e.component,n=e.getAPIMethods,r=e.layoutProps,s=e.isPrivate,o=e.noDefaultLoader,i=e.pageActivatorFeature,a=e.redirectIfLogin,u=e.afterLogin,l=e.disableSSR,c=e.dataProps;return t.getAPIMethods=n,t.layoutProps=r,t.isPrivate=s,t.noDefaultLoader=o,t.pageActivatorFeature=i,t.redirectIfLogin=a,t.afterLogin=u,t.disableSSR=l,t.dataProps=c,t}n.d(t,{D:function(){return r}})},95846:function(e,t,n){"use strict";n.d(t,{R:function(){return o}});var r=n(52216),s={MILLISECOND:"میلی ثانیه",SECOND:"ثانیه",MINUTE:"دقیقه",HOUR:"ساعت",DAY:"روز"};function o(e,t,n){var o=t.hasHours,i=t.hasDays,a=void 0===i||i,u=t.hasMilliseconds,l=void 0!==u&&u,c=t.isArray,d=t.hasText;if(e<=0)return(null==n?void 0:n.current)&&clearInterval(n.current),0;var m=[];if(l){var f=String(e%1e3||0).padStart(3,"0");m.push({text:s.MILLISECOND,value:f})}var p=(g=(x={time:e,hasMilliseconds:l}).time,String((void 0!==(N=x.hasMilliseconds)&&N?Math.floor(g/1e3)%60:g%60)||0).padStart(2,"0")),h=(S=(w={time:e,hasMilliseconds:l}).time,String((void 0!==(j=w.hasMilliseconds)&&j?Math.floor(S/6e4%60):Math.floor(S/60%60))||0).padStart(2,"0"));if(m.push({text:s.SECOND,value:p},{text:s.MINUTE,value:h}),void 0===o||o){var v=(O=(y={time:e,hasMilliseconds:l,hasDays:a}).time,b=y.hasDays,M=Math.floor((y.hasMilliseconds?Math.floor(O/1e3):O)/3600),b?String(M%24||0).padStart(2,"0"):String(M||0).padStart(2,"0"));if(m.push({text:s.HOUR,value:v}),(!l&&e>86400||l&&e>864e5)&&a){var x,g,N,w,S,j,y,O,b,M,_,P,C,I=(P=(_={time:e,hasMilliseconds:l}).time,void 0!==(C=_.hasMilliseconds)&&C?String(Math.floor(P/864e5)||0):String(Math.floor(P/86400)||0));m.push({text:s.DAY,value:I})}}return void 0!==d&&d?m:void 0!==c&&c?m.map(function(e){return e.value}):(0,r.U)(m.map(function(e){return e.value}).join(" : ").replace(l?/:([^.]+)$/:"",l?".$1":""))}},77997:function(e){e.exports={AccountWrapper__mainBox:"account-wrapper_AccountWrapper__mainBox__cC78z"}},82023:function(e){e.exports={codeInput__trackingOtp:"styles_codeInput__trackingOtp__mhz1j"}}},function(e){e.O(0,[9774,2888,179],function(){return e(e.s=19401)}),_N_E=e.O()}]);